{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Module PgRouting # Lizmap 3.5 minium install the module. configure the QGIS project. Funded by CRIGE PACA in France","title":"Home"},{"location":"#module-pgrouting","text":"Lizmap 3.5 minium install the module. configure the QGIS project. Funded by CRIGE PACA in France","title":"Module PgRouting"},{"location":"CHANGELOG/","text":"Changelog # Unreleased # Adding some check for sql query result Adding class to check configuration (Database extension and structure, Project layers required) 0.1.0 - 2021-06-22 # First version of the module","title":"Changelog"},{"location":"CHANGELOG/#changelog","text":"","title":"Changelog"},{"location":"CHANGELOG/#unreleased","text":"Adding some check for sql query result Adding class to check configuration (Database extension and structure, Project layers required)","title":"Unreleased"},{"location":"CHANGELOG/#010-2021-06-22","text":"First version of the module","title":"0.1.0 - 2021-06-22"},{"location":"CONTRIBUTING/","text":"Contribution # You can contribute to the SQL code or the frontend Lizmap interface.","title":"Contribution"},{"location":"CONTRIBUTING/#contribution","text":"You can contribute to the SQL code or the frontend Lizmap interface.","title":"Contribution"},{"location":"changelog/","text":"Changelog # Unreleased # Adding some check for sql query result Adding class to check configuration (Database extension and structure, Project layers required) 0.1.0 - 2021-06-22 # First version of the module","title":"Changelog"},{"location":"changelog/#changelog","text":"","title":"Changelog"},{"location":"changelog/#unreleased","text":"Adding some check for sql query result Adding class to check configuration (Database extension and structure, Project layers required)","title":"Unreleased"},{"location":"changelog/#010-2021-06-22","text":"First version of the module","title":"0.1.0 - 2021-06-22"},{"location":"configuration/","text":"Configuration # Data integration # Once the module is installed, you have to fill the tables with your data. Here is an example based on the French IGN BDTopo route layer loaded in myschema.bdtopo . In this query the function pgrouting.create_edge is used. It allows to create edges and creating the nodes at the start and end of the edge. This function required some parameters like: geom , it's the geometry retrieved from your layer cost , currently calculated according to the direction of travel of the road reverse_cost , currently calculated according to the direction of travel of the road The edges table contains all road with some field required for pgrouting. Depending on your source layer, you might not have the same field names. Here, bd.geom is the geometry field, bd.sens is the direction field, bd.nom_1_g is the road name filed. For these fields, bd is the alias of the table, so you only need to modify the part after the point. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 INSERT INTO pgrouting . edges_info ( id , label , length ) SELECT pgrouting . create_edge ( ST_geometryN ( bd . geom , 1 ), CASE WHEN bd . sens in ( 'Sans objet' , 'Double sens' , 'Sens direct' ) THEN ST_length ( bd . geom ) ELSE - 1 END , CASE WHEN bd . sens in ( 'Sans objet' , 'Double sens' , 'Sens inverse' ) THEN ST_length ( bd . geom ) ELSE - 1 END ), bd . nom_1_g , ST_length ( bd . geom ) FROM myschema . bdtopo bd ; Here is an example based on point of interest layer loaded in myschema.point_of_interest . This query refill the pgrouting.routing_poi table. In the select you can replace the fields by your fields on your point of interest layer. 1 2 3 INSERT INTO pgrouting . routing_poi ( label , type , description , geom ) SELECT poi . label , poi . type , poi . description , poi . geom FROM myschema . point_of_interest poi ; In QGIS # Configure QGIS project # To use the pgrouting module in Lizmap Web Client you must first configure a QGIS project : We offer you here a basic project which contains only the layers required and configured for Lizmap. If you want create your project or use another existing project to use this module: Add the Edges and Nodes layers The QGIS project must be called pgrouting.qgs You must then create configuration for Lizmap with the Lizmap plugin. No specific configuration was needed for the module. You can configure like you want or just click on apply button.","title":"Configuraton"},{"location":"configuration/#configuration","text":"","title":"Configuration"},{"location":"configuration/#data-integration","text":"Once the module is installed, you have to fill the tables with your data. Here is an example based on the French IGN BDTopo route layer loaded in myschema.bdtopo . In this query the function pgrouting.create_edge is used. It allows to create edges and creating the nodes at the start and end of the edge. This function required some parameters like: geom , it's the geometry retrieved from your layer cost , currently calculated according to the direction of travel of the road reverse_cost , currently calculated according to the direction of travel of the road The edges table contains all road with some field required for pgrouting. Depending on your source layer, you might not have the same field names. Here, bd.geom is the geometry field, bd.sens is the direction field, bd.nom_1_g is the road name filed. For these fields, bd is the alias of the table, so you only need to modify the part after the point. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 INSERT INTO pgrouting . edges_info ( id , label , length ) SELECT pgrouting . create_edge ( ST_geometryN ( bd . geom , 1 ), CASE WHEN bd . sens in ( 'Sans objet' , 'Double sens' , 'Sens direct' ) THEN ST_length ( bd . geom ) ELSE - 1 END , CASE WHEN bd . sens in ( 'Sans objet' , 'Double sens' , 'Sens inverse' ) THEN ST_length ( bd . geom ) ELSE - 1 END ), bd . nom_1_g , ST_length ( bd . geom ) FROM myschema . bdtopo bd ; Here is an example based on point of interest layer loaded in myschema.point_of_interest . This query refill the pgrouting.routing_poi table. In the select you can replace the fields by your fields on your point of interest layer. 1 2 3 INSERT INTO pgrouting . routing_poi ( label , type , description , geom ) SELECT poi . label , poi . type , poi . description , poi . geom FROM myschema . point_of_interest poi ;","title":"Data integration"},{"location":"configuration/#in-qgis","text":"","title":"In QGIS"},{"location":"configuration/#configure-qgis-project","text":"To use the pgrouting module in Lizmap Web Client you must first configure a QGIS project : We offer you here a basic project which contains only the layers required and configured for Lizmap. If you want create your project or use another existing project to use this module: Add the Edges and Nodes layers The QGIS project must be called pgrouting.qgs You must then create configuration for Lizmap with the Lizmap plugin. No specific configuration was needed for the module. You can configure like you want or just click on apply button.","title":"Configure QGIS project"},{"location":"contributing/","text":"Contribution # You can contribute to the SQL code or the frontend Lizmap interface.","title":"Contribution"},{"location":"contributing/#contribution","text":"You can contribute to the SQL code or the frontend Lizmap interface.","title":"Contribution"},{"location":"installation/","text":"requirements # a Postgresql database with the pgrouting extension Installation # Before install the module you need to configure a profile in your config Lizmap. You need to add in lizmap/var/config/profiles.ini.php : Only replace host, database, user and password values. 1 2 3 4 5 6 7 8 9 [jdb:pgrouting] driver = pgsql host = pgsql port = 5432 database = lizmap user = lizmap password = \"yourpassword\" search_path = pgrouting,public Manual installation into lizmap 3.5 only without Composer # Get the last ZIP archive in the repository page . Extract the archive and copy the pgrouting directory in Lizmap Web Client folder lizmap/lizmap-modules/ Edit the config file lizmap/var/config/localconfig.ini.php and add into the section [modules] : 1 2 pgrouting.access = 2 pgrouting.installparam = \"srid=2154\" You can replace 2154 by another SRID that you use. Then execute Lizmap install scripts into lizmap/install/ : 1 2 3 php lizmap/install/installer.php ./lizmap/install/clean_vartmp.sh ./lizmap/install/set_rights.sh","title":"Installation"},{"location":"installation/#requirements","text":"a Postgresql database with the pgrouting extension","title":"requirements"},{"location":"installation/#installation","text":"Before install the module you need to configure a profile in your config Lizmap. You need to add in lizmap/var/config/profiles.ini.php : Only replace host, database, user and password values. 1 2 3 4 5 6 7 8 9 [jdb:pgrouting] driver = pgsql host = pgsql port = 5432 database = lizmap user = lizmap password = \"yourpassword\" search_path = pgrouting,public","title":"Installation"},{"location":"installation/#manual-installation-into-lizmap-35-only-without-composer","text":"Get the last ZIP archive in the repository page . Extract the archive and copy the pgrouting directory in Lizmap Web Client folder lizmap/lizmap-modules/ Edit the config file lizmap/var/config/localconfig.ini.php and add into the section [modules] : 1 2 pgrouting.access = 2 pgrouting.installparam = \"srid=2154\" You can replace 2154 by another SRID that you use. Then execute Lizmap install scripts into lizmap/install/ : 1 2 3 php lizmap/install/installer.php ./lizmap/install/clean_vartmp.sh ./lizmap/install/set_rights.sh","title":"Manual installation into lizmap 3.5 only without Composer"}]}